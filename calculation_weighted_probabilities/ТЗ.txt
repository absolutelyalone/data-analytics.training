"""
ТЗ:
1)
по каждму скору (age, sex) посчитать взвешенную вероятность
то есть

взять по 75% от выборки случайно, сгруппировать по age_score/sex_score, посчитать среднее значение target
взять в итоге среднеепо 10 тестам

то есть
есть скор по возраст 0,05, 1 тест: берем 75% выборки случайно и считаем среднее значение на этот скорбалл по Target
                           2 тест: берем 75% выборки случайно и считаем среднее значение на этот скорбалл по Target
                           итд
                           в результате скалыдваем среднее по 10 и делим на 10 (или иначе считай среднее), если догадаешься
                           
и так на каждый скорбалл по возрасту
 
потом на каждый по полу
это взвешенная вероятность
например такой результат:
скорбалл  метрик   а  взвешенная вероятность
0           age_score        0.03
0.05        age_score        0.04
....
...
0.95          sex_score      0.7

2) сопоставь age_score с его взвешенной веротностью по каждому id, аналогично с sex_score
было
id	Target	total_score	age_score	sex_score
0    0       0.05        0.1         0.15        
стало
id	Target	total_score	age_score	sex_score age_score_prob sex_score_prob
0   0        0.05          0.1        0.15        0.12         0.21
......


3) сгруппируй по total_score их и посчитай взвешенную вероятность еще раз
то есть
у тебя total_score может быть 0, 0.05, 0.1 итд
на каждый общий скор нужно сделать:
total_score age_score_prob sex_score_prob
0             0.05            0.06
0.05          0.06            0.06
0.1           0.11            0.08
итд
как считать:
на общий скор 0 выбираем только записи с таким скором
берем из них случайные 75%, считаем среднее (но теперь не Target, а age_score_prob)

то есть, выбрали из тех, у кого total_score 0 случайные 75%, например, 4 записи
id	Target	total_score	   age_score_prob sex_score_prob
0    0       0              0.1           0.15       
1    1       0              0.15          0.25   
2    0       0              0.15          0.2   
3    0       0              0.1           0.15  
по ним посчитали среднее age_score_prob = (0.1+0.15+0.15+0.1)/4=...
                         sex_score_prob = (0.15+0.25+0.2+0.15)/4=...
                         
и снова так 10 раз и усреднить по 1 тестам
например, было на тесте 1 на скорбалл 0 значение 0.1
было на тесте 2 на скорбалл 0 значение 0.11
....
было на тесте 10 на скорбалл 0 значение 0.11
(0+0.11+...+0.11)/10 (число тестов)




Это поля ответа:
total_score age_score_prob sex_score_prob
0             0.05            0.06
0.05          0.06            0.06
0.1           0.11            0.08
....
"""